{% extends "base.html" %}
{% block content %}
<section class="hero-card">
    <div class="hero-avatar">Blog</div>
    <div class="hero-content">
        <p class="eyebrow">è¿·ä½  Socket åšå®¢</p>
        <h1>æ¬¢è¿æ¥åˆ° è®¡ç½‘å¤§ä½œä¸š åšå®¢</h1>
        <p class="lead">æ°´æ–‡çš„ç‹‚æ¬¢</p>
        <div class="hero-actions">
            <a class="pill-btn" href="/posts/new"> ç«‹å³å†™æ–‡ç« </a>
            <a class="ghost-btn" href="/monitor"> æŸ¥çœ‹ç½‘ç»œæŒ‡æ ‡</a>
        </div>
    </div>
    <div class="hero-stats">
        <div>
            <p class="label">æ–‡ç« æ€»æ•°</p>
            <p class="value">{{ post_stats.total_posts if post_stats is defined and post_stats else 0 }}</p>
        </div>
        <div>
            <p class="label">æœ€æ–°æ›´æ–°</p>
            <p class="value">{{ post_stats.latest_created_at if post_stats is defined and post_stats and post_stats.latest_created_at else 'æš‚æ— æ•°æ®' }}</p>
        </div>
        <div>
            <p class="label">æœ€æ–°æ–‡ç« </p>
            <p class="value">{{ latest_post.title if latest_post else 'ç­‰å¾…åˆ›ä½œ' }}</p>
        </div>
    </div>
</section>

<section class="quick-nav">
    <div class="section-header">
        <h2>å¿«æ·å¯¼èˆª</h2>
        <p>å¿«é€ŸæŸ¥çœ‹å¸¸ç”¨åˆ†ç±»æˆ–åŠŸèƒ½</p>
    </div>
    <div class="nav-grid">
        <a class="nav-card" href="/profile">ğŸ‘¤ ä¸ªäººä¸­å¿ƒ</a>
        <a class="nav-card" href="/monitor">âš¡ ç½‘ç»œç›‘æµ‹</a>
        <a class="nav-card" href="/posts/new">ğŸ“ å†™æ–‡ç« </a>
        {% for cat in categories %}
        <a class="nav-card" href="/?tag={{ cat.category }}">#{{ cat.category }} Â· {{ cat.count }} ç¯‡</a>
        {% endfor %}
    </div>
</section>

<section class="search-panel elevated">
    <form method="get" action="/">
        <div class="input-group">
            <label>æœç´¢</label>
            <input type="text" name="q" placeholder="æœç´¢æ ‡é¢˜æˆ–æ­£æ–‡" value="{{ keyword }}">
        </div>
        <div class="input-group">
            <label>åˆ†ç±»</label>
            <select name="tag">
                <option value="">å…¨éƒ¨åˆ†ç±»</option>
                {% for cat in categories %}
                <option value="{{ cat.category }}" {% if tag == cat.category %}selected{% endif %}>{{ cat.category }} ({{ cat.count }})</option>
                {% endfor %}
            </select>
        </div>
        <button type="submit">å¼€å§‹æ¢ç´¢</button>
    </form>
</section>

<section class="post-list modern">
    <div class="section-header">
        <h2>æœ€æ–°æ–‡ç« </h2>
        <a href="/profile">æŸ¥çœ‹æˆ‘çš„å‘å¸ƒ â†’</a>
    </div>
    {% if posts %}
        <div class="post-grid">
        {% for post in posts %}
        <article class="post-card">
            <div class="post-meta">
                <span class="badge">{{ post.tags or 'æœªåˆ†ç±»' }}</span>
                <span>{{ post.created_at }}</span>
            </div>
            <h3><a href="/posts/{{ post.id }}">{{ post.title }}</a></h3>
            <p>{{ post.body[:160] }}{% if post.body|length > 160 %}...{% endif %}</p>
            <div class="post-footer">
                <div class="author">{{ post.author_name }}</div>
                <div class="stats">
                    <span>ğŸ‘ {{ post.like_count }}</span>
                    <span>â­ {{ post.favorite_count }}</span>
                </div>
            </div>
        </article>
        {% endfor %}
        </div>
    {% else %}
        <div class="empty-state">
            <p>è¿˜æ²¡æœ‰æ–‡ç« ï¼Œèµ¶ç´§æˆä¸ºç¬¬ä¸€ä½ä½œè€…å§ï¼</p>
            <a class="pill-btn" href="/posts/new">å¼€å§‹åˆ›ä½œ</a>
        </div>
    {% endif %}
</section>
{% endblock %}
